#!/usr/bin/env python

from pwn import *
from LibSearcher import *


r = process("./sleepyHolder_hitcon_2016")
elf = ELF('./sleepyHolder_hitcon_2016')

puts_plt = elf.plt['puts']
free_got = elf.got['free']
atoi_got = elf.got['atoi']

small_buf_addr = 0x00000000006020D0


def add(type,content):
	sh.sendlineafter('3. Renew secret\n','1')
	sh.sendlineafter('What secret do you want to keep?',str(type))
	sh.sendafter('Tell me your secret:',content)
		  
def delete(type):
	sh.sendlineafter('3. Renew secret\n','2')
	sh.sendlineafter('Which Secret do you want to wipe?',str(type))
				 
def edit(type,content):
	sh.sendlineafter('3. Renew secret\n','3')
	sh.sendlineafter('Which Secret do you want to renew?',str(type))
	sh.sendafter('Tell me your secret:',content)


add(1, 'a'*0x20)
add(2, 'b'*0x20)

#1 add to fastbin


r.interactive()
